# cake-autortt (Ubuntu/Debian)

## ๐ Language / ่ฏญ่จ / Bahasa / ะฏะทัะบ / ่จ่ช / Ngรดn ngแปฏ / Dil / ุงููุบุฉ

[English](README.md) | [ไธญๆ](README_zh.md) | [Bahasa Indonesia](README_id.md) | [ะัััะบะธะน](README_ru.md) | [ๆฅๆฌ่ช](README_ja.md) | [Tiแบฟng Viแปt](README_vi.md) | [Tรผrkรงe](README_tr.md) | **ุงูุนุฑุจูุฉ**

---

**ูุถุจุท ุชููุงุฆูุงู ูุนุงูู RTT ูู CAKE qdisc ุจูุงุกู ุนูู ุธุฑูู ุงูุดุจูุฉ ุงูููุงุณุฉ**

ูุฐุง ูู **ุฅุตุฏุงุฑ Ubuntu/Debian** ูู cake-autorttุ ููุนุฏูู ูุชูุฒูุนุงุช Linux ุงูููุงุณูุฉ ุงูุชู ุชุณุชุฎุฏู systemd ูุฅุฏุงุฑุฉ ุญุฒู apt ููููุงุช ุงูุชูููู ุงูุชูููุฏูุฉ ุจุฏูุงู ูู ูุธุงู UCI ุงูุฎุงุต ุจู OpenWrt.

## ๐ ููุงุฐุง ูุฐุง ููู ูุชุฌุฑุจุฉ ุงูุฅูุชุฑูุช ุงูุฎุงุตุฉ ุจู

ูุนุธู ุงููุณุชุฎุฏููู ูุนุชุงุฏูู ุนูู ุงูุชุญููู ุงูุณุฑูุน ููููุงูุน ุงูุฑุฆูุณูุฉ ูุซู YouTube ูNetflix ูGoogle - ูุฐู ุชุณุชุฎุฏู ุดุจูุงุช ุชูุตูู ุงููุญุชูู (CDNs) ููุถุน ุงูุฎูุงุฏู ูุฑูุจุงู ุฌุฏุงู ูู ุงููุณุชุฎุฏูููุ ูุนุงุฏุฉ ูุง ุชููุฑ ุฃููุงุช ุงุณุชุฌุงุจุฉ ุฃูู ูู 50-100ms. ููุน ุฐููุ ูุฅู ุงูุฅูุชุฑูุช ุฃูุณุน ุจูุซูุฑ ูู ูุฐู ุงูููุตุงุช ุงููุจูุฑุฉ.

**ุนูุฏูุง ุชุชุตูุญ ููุงูุน ุงูููุจ ุฎุงุฑุฌ ุชูู ุงููุฏุนููุฉ ุจู CDN ุงูุฑุฆูุณูุฉุ ุชูุงุฌู ุนุงููุงู ูุชููุนุงู ูู ุงูุฎูุงุฏู:**
- **ุงูุฎุฏูุงุช ุงููุญููุฉ/ุงูุฅูููููุฉ**: ุงูุดุฑูุงุช ุงูุตุบูุฑุฉ ูููุงูุน ุงูุฃุฎุจุงุฑ ุงููุญููุฉ ูููุชุฏูุงุช ุงููุฌุชูุน ูุงูุฎุฏูุงุช ุงูุฅูููููุฉ ุบุงูุจุงู ูุง ุชููู ูุฏููุง ุฎูุงุฏู ูู ุจูุฏู ุฃู ููุทูุชู (10-50ms RTT)
- **ุงููุญุชูู ุงูุฏููู**: ุงูููุงูุน ุงููุชุฎุตุตุฉ ูุงูููุงุฑุฏ ุงูุฃูุงุฏูููุฉ ูุฎูุงุฏู ุงูุฃูุนุงุจ ูุงูุฎุฏูุงุช ุงููุชุฎุตุตุฉ ูุฏ ุชููู ูุณุชุถุงูุฉ ูู ูุงุฑุงุช ุฃุฎุฑู (100-500ms RTT)
- **ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุจุนูุฏุฉ**: ุจุนุถ ุงูุฎุฏูุงุชุ ุฎุงุตุฉ ูู ุงูููุงุทู ุงููุงููุฉ ุฃู ุงูุชุทุจููุงุช ุงููุชุฎุตุตุฉุ ูุฏ ุชููู ูุฏููุง ุฒูู ุงุณุชุฌุงุจุฉ ุฃุนูู ุจุดูู ูุจูุฑ

**ูุนุงูู RTT ุงูุฎุงุต ุจู CAKE ูุชุญูู ูู ูุฏู ุนุฏูุงููุฉ ุฎูุงุฑุฒููุฉ ุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ ูู ุงูุงุณุชุฌุงุจุฉ ููุงุฒุฏุญุงู.** ุงูุชุฑุงุถูุงูุ ูุณุชุฎุฏู CAKE ุงูุชุฑุงุถ RTT ุจู 100msุ ูุงูุฐู ูุนูู ุจุดูู ุฌูุฏ ุฅูู ุญุฏ ูุง ูุญุฑูุฉ ุงูุฅูุชุฑูุช ุงูุนุงูุฉ. ููุน ุฐูู:

- **ุฅุนุฏุงุฏ RTT ููุฎูุถ ุฌุฏุงู**: ุฅุฐุง ุงุนุชูุฏ CAKE ุฃู RTT ููุดุจูุฉ ุฃูุตุฑ ููุง ูู ุนููู ูุนูุงูุ ูุตุจุญ ุนุฏูุงููุงู ุฌุฏุงู ูู ุฅุณูุงุท ุงูุญุฒู ุนูุฏูุง ุชุชุฑุงูู ุงูุทูุงุจูุฑุ ููุง ูุฏ ูููู ูู ุนุฑุถ ุงููุทุงู ููุฎูุงุฏู ุงูุจุนูุฏุฉ
- **ุฅุนุฏุงุฏ RTT ุนุงูู ุฌุฏุงู**: ุฅุฐุง ุงุนุชูุฏ CAKE ุฃู RTT ููุดุจูุฉ ุฃุทูู ููุง ูู ุนููู ูุนูุงูุ ูุตุจุญ ูุญุงูุธุงู ุฌุฏุงู ููุณูุญ ุจุชุฑุงูู ุทูุงุจูุฑ ูุจูุฑุฉุ ููุง ูุฎูู ุฒูู ุงุณุชุฌุงุจุฉ ุบูุฑ ุถุฑูุฑู ููุฎูุงุฏู ุงููุฑูุจุฉ

**ุฃูุซูุฉ ุนูู ุงูุชุฃุซูุฑ ูู ุงูุนุงูู ุงูุญูููู:**
- **ูุณุชุฎุฏู ุณูุบุงููุฑุฉ โ ุฎุงุฏู ุฃููุงูู**: ุจุฏูู ุถุจุท RTTุ ูุฏ ููุงุฌู ูุณุชุฎุฏู ูู ุณูุบุงููุฑุฉ ูุตู ุฅูู ูููุน ุฃููุงูู (โ180ms RTT) ุนุฑุถ ูุทุงู ูููู ุจุณุจุจ ุฅุนุฏุงุฏ CAKE ุงูุงูุชุฑุงุถู 100ms ุงูุฐู ูุณุจุจ ุฅุณูุงุท ุงูุญุฒู ุงููุจูุฑ
- **ุฑูู ุฃูุฑููุง โ ุฎุงุฏู ุฅููููู**: ูุฏ ููุงุฌู ูุณุชุฎุฏู ูู ุฑูู ุฃูุฑููุง ูุตู ุฅูู ุฎุงุฏู ุฅููููู (โ25ms RTT) ุฒูู ุงุณุชุฌุงุจุฉ ุฃุนูู ูู ุงูุถุฑูุฑู ูุฃู ุฅุนุฏุงุฏ CAKE ุงูุงูุชุฑุงุถู 100ms ูุณูุญ ุจุชุทููุฑ ุทูุงุจูุฑ ุฃูุซุฑ ูู ุงููุงุฒู
- **ุชุทุจููุงุช ุงูุฃูุนุงุจ/ุงูููุช ุงููุนูู**: ุงูุชุทุจููุงุช ุงูุญุณุงุณุฉ ููู ูู ุฒูู ุงูุงุณุชุฌุงุจุฉ ูุนุฑุถ ุงููุทุงู ุชุณุชููุฏ ุจุดูู ูุจูุฑ ูู ุถุจุท RTT ุงูููุงุณุจ ูุธุฑูู ุงูุดุจูุฉ ุงููุนููุฉ

**ููู ูุณุงุนุฏ cake-autortt:**
ูู ุฎูุงู ููุงุณ RTT ุงููุนูู ููุฎูุงุฏู ุงูุชู ุชุชูุงุตู ูุนูุง ุชููุงุฆูุงู ูุถุจุท ูุนุงููุงุช CAKE ูููุงู ูุฐููุ ุชุญุตู ุนูู:
- **ุงุณุชุฌุงุจุฉ ุฃุณุฑุน** ุนูุฏ ุงููุตูู ููุฎูุงุฏู ุงููุฑูุจุฉ (RTT ุฃูุตุฑ โ ุฅุฏุงุฑุฉ ุทูุงุจูุฑ ุฃูุซุฑ ุนุฏูุงููุฉ)
- **ุนุฑุถ ูุทุงู ุฃูุถู** ุนูุฏ ุงููุตูู ููุฎูุงุฏู ุงูุจุนูุฏุฉ (RTT ุฃุทูู โ ุฅุฏุงุฑุฉ ุทูุงุจูุฑ ุฃูุซุฑ ุตุจุฑุงู)
- **ุชุญูู ูุซุงูู ูู bufferbloat** ูุชููู ูุน ุธุฑูู ุงูุดุจูุฉ ุงููุนููุฉ ุจุฏูุงู ูู ุงูุงูุชุฑุงุถุงุช

ูุฐุง ูููุฏ ุจุดูู ุฎุงุต ูููุณุชุฎุฏููู ุงูุฐูู ูุตููู ุจุงูุชุธุงู ููุตุงุฏุฑ ูุญุชูู ูุชููุนุฉุ ุฃู ูุนูููู ูุน ุฎุฏูุงุช ุฏูููุฉุ ุฃู ูุนูุดูู ูู ููุงุทู ุญูุซ ุญุฑูุฉ ุงูุฅูุชุฑูุช ุชุณุงูุฑ ุนุงุฏุฉ ูุณุงูุงุช ูุจูุฑุฉ.

## ๐ ุงูููุฒุงุช

- **ุงูุชุดุงู RTT ุงูุชููุงุฆู**: ูุฑุงูุจ ุงูุงุชุตุงูุงุช ุงููุดุทุฉ ุนุจุฑ `/proc/net/nf_conntrack` ููููุณ RTT ูููุถูููู ุงูุฎุงุฑุฌููู
- **ุชุตููุฉ ุงููุถูููู ุงูุฐููุฉ**: ูุตูู ุชููุงุฆูุงู ุนูุงููู LAN ููุฑูุฒ ุนูู ุงููุถูููู ุงูุฎุงุฑุฌููู
- **ุฎูุงุฑุฒููุฉ RTT ุงูุฐููุฉ**: ูุณุชุฎุฏู ุฃูุฑ ping ุงููุฏูุฌ ูููุงุณ RTT ูุฑุฏู ููู ูุถูู (3 pings ููู ูุถูู)ุ ุซู ูุฎุชุงุฑ ุจุฐูุงุก ุจูู ูุชูุณุท ูุฃุณูุฃ RTT ููุฃุฏุงุก ุงูุฃูุซู
- **ุงูุชุดุงู ุงููุงุฌูุฉ ุงูุชููุงุฆู**: ููุชุดู ุชููุงุฆูุงู ุงููุงุฌูุงุช ุงูุชู ุชู ุชูููู CAKE ุนูููุง
- **ุชูุงูู systemd**: ูุนูู ูุฎุฏูุฉ systemd ููุงุณุจุฉ ูุน ุจุฏุก ุชุดุบูู ุชููุงุฆู ูุฅุฏุงุฑุฉ ุงูุนูููุงุช
- **ูุนุงููุงุช ูุงุจูุฉ ููุชูููู**: ุฌููุน ูุนุงููุงุช ุงูุชูููุช ูุงูุณููู ูุงุจูุฉ ููุชูููู ุนุจุฑ ููู ุงูุชูููู
- **ูุนุงูุฌุฉ ุฃุฎุทุงุก ูููุฉ**: ูุชุนุงูู ุจุฃูุงูุฉ ูุน ุงูุชุจุนูุงุช ุงูููููุฏุฉ ููุดุงูู ุงูุดุจูุฉ ูุชุบููุฑุงุช ุงููุงุฌูุฉ
- **ุชุจุนูุงุช ุฏููุง**: ูุญุชุงุฌ ููุท ping ูtc - ูุง ุญุงุฌุฉ ูุญุฒู ุฅุถุงููุฉุ ูุณุชุฎุฏู ุฃุฏูุงุช ูุฏูุฌุฉ ูุชููุฑุฉ ุนูู ุฌููุน ุงูุฃูุธูุฉ
- **RTT ุนุงูู ุงูุฏูุฉ**: ูุฏุนู ููู RTT ุงููุณุฑูุฉ (ูุซู 100.23ms) ูุชูููุช ุงูุดุจูุฉ ุงูุฏููู

## ๐ง ุงูุชูุงูู

**ุชู ุงุฎุชุจุงุฑู ููุนูู:**
- **Ubuntu 20.04+ (Focal ููุง ุจุนุฏู)**
- **Debian 10+ (Buster ููุง ุจุนุฏู)**

**ุงูุชูุงูู ุงููุชููุน:**
- ุฃู ุชูุฒูุนุฉ Linux ูุงุฆูุฉ ุนูู systemd ูุน ุฏุนู CAKE qdisc
- ุงูุชูุฒูุนุงุช ูุน ุญุฒูุฉ iproute2 ุญุฏูุซุฉ

**ูุชุทูุจุงุช ุงูุชูุงูู:**
- ูุญุฏุฉ kernel CAKE qdisc (ูุชููุฑุฉ ูู Linux 4.19+)
- ุฃุฏุงุฉ ping (ูุถููุฉ ูู ุฌููุน ุชูุฒูุนุงุช Linux ุงูููุงุณูุฉ)
- ุฅุฏุงุฑุฉ ุฎุฏูุฉ systemd
- iproute2 ูุน ุฃุฏุงุฉ tc (ุชุญูู ูู ุญุฑูุฉ ุงููุฑูุฑ)
- ุฏุนู /proc/net/nf_conntrack (netfilter conntrack)

## ๐ ุงููุชุทูุจุงุช

### ุงูุชุจุนูุงุช
- **ping**: ุฃุฏุงุฉ ping ุงูููุงุณูุฉ ูููุงุณ RTT (ูุถููุฉ ูู ุฌููุน ุชูุฒูุนุงุช Linux)
- **tc**: ุฃุฏุงุฉ ุชุญูู ุญุฑูุฉ ุงููุฑูุฑ (ุฌุฒุก ูู iproute2)
- **CAKE qdisc**: ูุฌุจ ุฃู ูููู ููููุงู ุนูู ุงููุงุฌูุงุช ุงููุณุชูุฏูุฉ
- **systemd**: ุฅุฏุงุฑุฉ ุงูุฎุฏูุฉ
- **netfilter conntrack**: ูุชุชุจุน ุงูุงุชุตุงูุงุช (/proc/net/nf_conntrack)

### ุชุซุจูุช ุงูุชุจุนูุงุช

```bash
# ุชุซุจูุช ุงูุญุฒู ุงููุทููุจุฉ
sudo apt update
sudo apt install iputils-ping iproute2

# ุงูุชุญูู ูู ุฏุนู tc ูู CAKE:
tc qdisc help | grep cake

# ุงูุชุญูู ูู ุชููุฑ conntrack
ls /proc/net/nf_conntrack
```

## ๐ง ุงูุชุซุจูุช

> [!IMPORTANT]  
> ูุจู ุชุดุบูู ุณูุฑูุจุช ุงูุชุซุจูุชุ ูุฌุจ ุนููู ุชูููู CAKE qdisc ุนูู ูุงุฌูุงุช ุงูุดุจูุฉ ุงูุฎุงุตุฉ ุจู ูุชุญุฑูุฑ ููู ุงูุชูููู ูุชุนููู ุฃุณูุงุก ุงููุงุฌูุงุช ุงูุตุญูุญุฉ ููุธุงูู.

### ุงููุชุทูุจ ุงูุฃุณุงุณู: ุชูููู CAKE qdisc

ุฃููุงูุ ุชุญุชุงุฌ ูุชูููู CAKE qdisc ุนูู ูุงุฌูุงุช ุงูุดุจูุฉ ุงูุฎุงุตุฉ ุจู. ูุฐุง ุนุงุฏุฉ ูุง ูุชู ุนูู ุงููุงุฌูุฉ ุงูููุงุฌูุฉ ููุฅูุชุฑูุช:

```bash
# ูุซุงู: ุชูููู CAKE ุนูู ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ
# ุงุณุชุจุฏู 'eth0' ุจุงุณู ูุงุฌูุชู ุงููุนูู
# ุงุณุชุจุฏู '100Mbit' ุจุนุฑุถ ุงููุทุงู ุงููุนูู ุงูุฎุงุต ุจู

# ููุชูููู ุงูุจุณูุท (ุงุณุชุจุฏู eth0 ุจูุงุฌูุชู):
sudo tc qdisc add root dev eth0 cake bandwidth 100Mbit

# ููุชูููู ุงููุชูุฏู ูุน ุชุดููู ingress:
# ุฅูุดุงุก ูุงุฌูุฉ ifb (intermediate functional block) ูุชุดููู ุงูุชุญููู
sudo modprobe ifb
sudo ip link add name ifb0 type ifb
sudo ip link set dev ifb0 up

# ุชูููู ุฅุนุงุฏุฉ ุชูุฌูู ุญุฑูุฉ ingress ูCAKE
sudo tc qdisc add dev eth0 handle ffff: ingress
sudo tc filter add dev eth0 parent ffff: protocol all u32 match u32 0 0 action mirred egress redirect dev ifb0
sudo tc qdisc add root dev ifb0 cake bandwidth 500Mbit ingress

# ุชูููู CAKE egress
sudo tc qdisc add root dev eth0 cake bandwidth 50Mbit

# ุงูุชุญูู ูู ุชูููู CAKE
tc qdisc show | grep cake
```

### ุงูุชุซุจูุช ุงูุณุฑูุน

1. **ุชูููู ูุงุฌูุงุช CAKE (ุงูุธุฑ ุงููุณู ุฃุนูุงู)**

2. **ุชุญุฑูุฑ ููู ุงูุชูููู:**

```bash
# ุชุญุฑูุฑ ููู ุงูุชูููู ูููุงุณุจ ุฃุณูุงุก ูุงุฌูุงุชู
nano etc/default/cake-autortt
```

3. **ุชูููู ุฃุณูุงุก ูุงุฌูุงุชู:**

ุญุฏูุซ ุฅุนุฏุงุฏุงุช `DL_INTERFACE` (ุงูุชุญููู) ู`UL_INTERFACE` (ุงูุฑูุน) ูุชูุงุณุจ ุชูููู ุดุจูุชู:

```bash
# ุฃูุซูุฉ ุชูููู ูุฅุนุฏุงุฏุงุช ูุฎุชููุฉ:

# ููุฅุนุฏุงุฏ ุงูุจุณูุท (ูุงุฌูุฉ ูุงุญุฏุฉ ูููุง ุงูุงุชุฌุงููู):
DL_INTERFACE="eth0"
UL_INTERFACE="eth0"

# ููุฅุนุฏุงุฏ ุงููุชูุฏู ูุน ูุงุฌูุฉ ifb ูุชุดููู ingress:
DL_INTERFACE="ifb0"     # ูุงุฌูุฉ ุงูุชุญููู (ifb ูุชุดููู ุญุฑูุฉ ingress)
UL_INTERFACE="eth0"     # ูุงุฌูุฉ ุงูุฑูุน (ุงููุงุฌูุฉ ุงูููุฒูุงุฆูุฉ)

# ูุฃุณูุงุก ูุงุฌูุงุช ูุฎุตุตุฉ:
DL_INTERFACE="enp3s0"   # ูุงุฌูุฉ ุงูุชุญููู ุงููุญุฏุฏุฉ ุงูุฎุงุตุฉ ุจู
UL_INTERFACE="enp3s0"   # ูุงุฌูุฉ ุงูุฑูุน ุงููุญุฏุฏุฉ ุงูุฎุงุตุฉ ุจู
```

**ููููุฉ ุงูุนุซูุฑ ุนูู ุฃุณูุงุก ูุงุฌูุงุชู:**
```bash
# ุณุฑุฏ ุงููุงุฌูุงุช ูุน CAKE qdisc
tc qdisc show | grep cake

# ุณุฑุฏ ุฌููุน ูุงุฌูุงุช ุงูุดุจูุฉ
ip link show

# ุงูุชุญูู ูู ูุงุฌูุฉ ุงูุดุจูุฉ ุงูุฑุฆูุณูุฉ
ip route | grep default
```

4. **ุชุดุบูู ุณูุฑูุจุช ุงูุชุซุจูุช:**

```bash
# ุฌุนู ุณูุฑูุจุช ุงูุชุซุจูุช ูุงุจูุงู ููุชูููุฐ ูุชุดุบููู
chmod +x install.sh
sudo ./install.sh
```

### ุงูุชุซุจูุช ุงููุฏูู

1. **ูุณุฎ ูููุงุช ุงูุฎุฏูุฉ ุฅูู ูุธุงูู:**

```bash
# ูุณุฎ ุงูููู ุงูุชูููุฐู ุงูุฑุฆูุณู
sudo cp usr/bin/cake-autortt /usr/bin/
sudo chmod +x /usr/bin/cake-autortt

# ูุณุฎ ููู ุฎุฏูุฉ systemd
sudo cp etc/systemd/system/cake-autortt.service /etc/systemd/system/

# ูุณุฎ ููู ุงูุชูููู
sudo cp etc/default/cake-autortt /etc/default/

# ูุณุฎ ูุงุนุฏุฉ udev ููุฑุงูุจุฉ ุงููุงุฌูุฉ
sudo cp etc/udev/rules.d/99-cake-autortt.rules /etc/udev/rules.d/

# ุฅุนุงุฏุฉ ุชุญููู systemd ูudev
sudo systemctl daemon-reload
sudo udevadm control --reload-rules
```

2. **ุชูููู ูุจุฏุก ุงูุฎุฏูุฉ:**

```bash
# ุชูููู ุงูุฎุฏูุฉ ููุจุฏุก ุงูุชููุงุฆู ุนูุฏ ุงูุฅููุงุน
sudo systemctl enable cake-autortt

# ุจุฏุก ุงูุฎุฏูุฉ
sudo systemctl start cake-autortt
```

## ๐๏ธ ุฅูุบุงุก ุงูุชุซุจูุช

ูุฅุฒุงูุฉ cake-autortt ูู ูุธุงูู:

```bash
# ุฌุนู ุณูุฑูุจุช ุฅูุบุงุก ุงูุชุซุจูุช ูุงุจูุงู ููุชูููุฐ ูุชุดุบููู
chmod +x uninstall.sh
sudo ./uninstall.sh
```

ุณูุฑูุจุช ุฅูุบุงุก ุงูุชุซุจูุช ุณูู:
- ูููู ููุนุทู ุงูุฎุฏูุฉ
- ูุฒูู ุฌููุน ุงููููุงุช ุงููุซุจุชุฉ
- ูุฒูู ุงุฎุชูุงุฑูุงู ูููุงุช ุงูุชูููู ูุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
- ููุธู ุงููููุงุช ุงููุคูุชุฉ

## โ๏ธ ุงูุชูููู

### ๐ง ุชูููู ุงููุงุฌูุฉ (ูุทููุจ)

**ุฎุทูุฉ ุงูุชูููู ุงูุฃูุซุฑ ุฃูููุฉ ูู ุชุนููู ุฃุณูุงุก ุงููุงุฌูุงุช ุงูุตุญูุญุฉ.** ุงูุฎุฏูุฉ ูู ุชุนูู ุจุดูู ุตุญูุญ ุจุฏูู ุฃุณูุงุก ุงููุงุฌูุงุช ุงูุตุญูุญุฉ.

```bash
# ุนุฑุถ ุงูุชูููู ุงูุญุงูู
cat /etc/default/cake-autortt

# ุชุญุฑูุฑ ุงูุชูููู
sudo nano /etc/default/cake-autortt

# ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ ูุชุทุจูู ุงูุชุบููุฑุงุช
sudo systemctl restart cake-autortt
```

ุงูุฎุฏูุฉ ููููุฉ ุนุจุฑ `/etc/default/cake-autortt`. ุฌููุน ุงููุนุงููุงุช ูููู ุชูููููุง ุจุชุญุฑูุฑ ูุฐุง ุงูููู.

### ูุนุงููุงุช ุงูุชูููู

| ุงููุนุงูู | ุงูุงูุชุฑุงุถู | ุงููุตู |
|-----------|---------|-------------|
| `DL_INTERFACE` | auto | ุงุณู ูุงุฌูุฉ ุงูุชุญููู (ูุซู 'eth0', 'ifb0') |
| `UL_INTERFACE` | auto | ุงุณู ูุงุฌูุฉ ุงูุฑูุน (ูุซู 'eth0', 'enp3s0') |
| `RTT_UPDATE_INTERVAL` | 5 | ุงูุซูุงูู ุจูู ุชุญุฏูุซุงุช ูุนุงูู qdisc RTT |
| `MIN_HOSTS` | 3 | ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงููุถูููู ุงููุทููุจ ูุญุณุงุจ RTT |
| `MAX_HOSTS` | 100 | ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงููุถูููู ูููุญุต ุจุงูุชุณูุณู |
| `RTT_MARGIN_PERCENT` | 10 | ูุงูุด ุงูุฃูุงู ุงููุถุงู ูู RTT ุงูููุงุณ (ูุณุจุฉ ูุฆููุฉ) |
| `DEFAULT_RTT_MS` | 100 | RTT ุงูุงูุชุฑุงุถู ุนูุฏูุง ูุง ุชุชููุฑ ูุถูููู ูุงูููู |
| `DEBUG` | 0 | ุชูููู ุชุณุฌูู ุงูุชุตุญูุญ (0=ุฅููุงูุ 1=ุชุดุบูู) |

> [!NOTE]  
> ุจูููุง ูุนุงููุงุช ุงููุงุฌูุฉ ููุง ุงูุชุฑุงุถู "auto"ุ ูุฏ ูุง ูุนูู ุงูุงูุชุดุงู ุงูุชููุงุฆู ุจุดูู ููุซูู ูู ุฌููุน ุงูุชููููุงุช. ูููุตุญ ุจุดุฏุฉ ุจุชุนููู ูุฐู ุงูููู ุตุฑุงุญุฉ.

> [!TIP]  
> ููุดุจูุงุช ุนุงููุฉ ุงููุดุงุท (ูุซู ุงูุญุฑู ุงูุฌุงูุนูุ ุงูุดุจูุงุช ุงูุนุงูุฉ ูุน ุงูุนุฏูุฏ ูู ุงููุณุชุฎุฏููู ุงููุดุทูู)ุ ููุฑ ูู ุถุจุท `RTT_UPDATE_INTERVAL` ุจูุงุกู ุนูู ุฎุตุงุฆุต ุดุจูุชู. ุงูุงูุชุฑุงุถู 5 ุซูุงูู ูุนูู ุจุดูู ุฌูุฏ ููุนุธู ุงูุญุงูุงุชุ ููู ููููู ุฒูุงุฏุชู ุฅูู 10-15 ุซุงููุฉ ููุดุจูุงุช ุงูุฃูุซุฑ ุงุณุชูุฑุงุฑุงู ุฃู ุชููููู ุฅูู 3 ุซูุงูู ููุจูุฆุงุช ุงูุฏููุงููููุฉ ุฌุฏุงู.

### ูุซุงู ุงูุชูููู

```bash
# /etc/default/cake-autortt

# ูุงุฌูุงุช ุงูุดุจูุฉ (ูุทููุจ - ููู ูุฅุนุฏุงุฏู)
DL_INTERFACE="ifb0"      # ูุงุฌูุฉ ุงูุชุญููู
UL_INTERFACE="eth0"      # ูุงุฌูุฉ ุงูุฑูุน

# ูุนุงููุงุช ุงูุชูููุช
RTT_UPDATE_INTERVAL=5    # ุชุญุฏูุซ RTT ูู 5 ุซูุงูู
MIN_HOSTS=3              # ูุญุชุงุฌ ูุญุฏ ุฃุฏูู 3 ูุถูููู ููููุงุณ
MAX_HOSTS=100            # ุนููุฉ ุญุฏ ุฃูุตู 100 ูุถูู
RTT_MARGIN_PERCENT=10    # ุฅุถุงูุฉ 10% ูุงูุด ุฃูุงู
DEFAULT_RTT_MS=100       # ูููุฉ RTT ุงูุงุญุชูุงุทูุฉ

# ุงูุชุตุญูุญ
DEBUG=0                  # ุชุนููู ุฅูู 1 ููุชุณุฌูู ุงูููุตู
```

## ๐ ููู ูุนูู

1. **ูุฑุงูุจุฉ ุงูุงุชุตุงู**: ูุญูู ุฏูุฑูุงู `/proc/net/nf_conntrack` ูุชุญุฏูุฏ ุงุชุตุงูุงุช ุงูุดุจูุฉ ุงููุดุทุฉ
2. **ุชุตููุฉ ุงููุถูู**: ูุณุชุฎุฑุฌ ุนูุงููู IP ุงููุฌูุฉ ููุตูู ุงูุนูุงููู ุงูุฎุงุตุฉ/LAN
3. **ููุงุณ RTT**: ูุณุชุฎุฏู `ping` ูููุงุณ RTT ูุฑุฏู ููู ูุถูู ุฎุงุฑุฌู (3 pings ููู ูุถูู)
4. **ุงุฎุชูุงุฑ RTT ุงูุฐูู**: ููุญุต ุงููุถูููู ุจุงูุชุณูุณู ูุชุฌูุจ ุงุฒุฏุญุงู ุงูุดุจูุฉุ ูุญุณุจ ูุชูุณุท ูุฃุณูุฃ RTTุ ุซู ูุณุชุฎุฏู ุงููููุฉ ุงูุฃุนูู ูุถูุงู ุงูุฃุฏุงุก ุงูุฃูุซู ูุฌููุน ุงูุงุชุตุงูุงุช
5. **ูุงูุด ุงูุฃูุงู**: ูุถูู ูุงูุดุงู ูุงุจูุงู ููุชูููู ูู RTT ุงูููุงุณ ูุถูุงู ุชุฎุฒูู ูุคูุช ูุงูู
6. **ุชุญุฏูุซ qdisc**: ูุญุฏูุซ ูุนุงูู CAKE qdisc RTT ุนูู ูุงุฌูุงุช ุงูุชุญููู ูุงูุฑูุน

### ๐ง ุฎูุงุฑุฒููุฉ RTT ุงูุฐููุฉ

ุงุนุชุจุงุฑุงู ูู ุงูุฅุตุฏุงุฑ 1.2.0ุ ูููุฐ cake-autortt ุฎูุงุฑุฒููุฉ ุงุฎุชูุงุฑ RTT ุฐููุฉ ุจูุงุกู ุนูู ุชูุตูุฉ Dave Tรคht (ูุคูู ูุดุงุฑู ูู CAKE):

**ุงููุดููุฉ**: ุงุณุชุฎุฏุงู ูุชูุณุท RTT ููุท ูููู ุฃู ูููู ูุดููุฉ ุนูุฏูุง ูููู ูุฏู ุจุนุถ ุงููุถูููู ุฒูู ุงุณุชุฌุงุจุฉ ุฃุนูู ุจุดูู ูุจูุฑ ูู ุงูุขุฎุฑูู. ุนูู ุณุจูู ุงููุซุงูุ ุฅุฐุง ูุงู ูุฏูู 100 ูุถูู ุจูุชูุณุท RTT 40msุ ููู 2 ูุถูู ูุฏูููุง RTT 234ms ู240msุ ูุฅู ุงุณุชุฎุฏุงู ูุชูุณุท 40ms ูููู ุฃู ูุณุจุจ ูุดุงูู ุฃุฏุงุก ูุชูู ุงูุงุชุตุงูุงุช ุนุงููุฉ ุงูุฒูู.

**ุงูุญู**: ุงูุฎูุงุฑุฒููุฉ ุงูุญุงููุฉ:
1. **ุชุญุณุจ ููุงู ูู ูุชูุณุท ูุฃุณูุฃ RTT** ูู ุฌููุน ุงููุถูููู ุงููุณุชุฌูุจูู
2. **ุชูุงุฑู ุงููููุชูู** ูุชุฎุชุงุฑ ุจุฐูุงุก ุงูููุงุณุจุฉ
3. **ุชุณุชุฎุฏู ุฃุณูุฃ RTT ุนูุฏูุง ูููู ุฃุนูู ุจุดูู ูุจูุฑ** ูู ุงููุชูุณุท ูุถูุงู ุฃุฏุงุก ุฌูุฏ ูุฌููุน ุงูุงุชุตุงูุงุช
4. **ุชุณุชุฎุฏู ูุชูุณุท RTT ุนูุฏูุง ูููู ุฃุณูุฃ RTT ูุฑูุจุงู** ูู ุงููุชูุณุท ูุชุฌูุจ ุงูุฅุนุฏุงุฏุงุช ุงููุญุงูุธุฉ ุฌุฏุงู

**ููุงุฐุง ูุฐุง ููู**: ูููุงู ูู [Dave Tรคht](https://forum.mikrotik.com/t/fq-codel-cake-stories/181067/17)ุ "ูู ุงูุฃูุถูุ ุฎุงุตุฉ ูุน ุชุดููู ingressุ ุงุณุชุฎุฏุงู RTT ุงููููุฐุฌู ูุชูุฏูุฑ ููุญุตูู ุนูู ุชุญูู ูู ุงูุทุงุจูุฑ ูุจู ูุตููู ุฅูู ูุดูู ISP ุงูุฐู ุชุญุงูู ุงูุชุบูุจ ุนููู." ููุน ุฐููุ ุฅุฐุง ูุงู RTT ุงููุนูู ูุฃู ูุถูู ุฃุทูู ูู RTT ุงููุนูู ุนูู ูุงุฌูุฉ CAKEุ ููุฏ ูุชุฃุซุฑ ุงูุฃุฏุงุก ุจุดุฏุฉ.

**ูุซุงู ูู ุงูุนุงูู ุงูุญูููู**:
- 98 ูุถูู ูุน RTT 30-50ms (ูุชูุณุท: 42ms)
- 2 ูุถูู ูุน RTT 200ms+ (ุฃุณูุฃ: 234ms)
- **ุงูุฎูุงุฑุฒููุฉ ุงููุฏููุฉ**: ุณุชุณุชุฎุฏู ูุชูุณุท 45msุ ูุณุจุจุฉ ูุดุงูู ูููุถูููู 200ms+
- **ุงูุฎูุงุฑุฒููุฉ ุงูุฌุฏูุฏุฉ**: ุชุณุชุฎุฏู ุฃุณูุฃ RTT 234msุ ูุถูููุฉ ุงูุฃุฏุงุก ุงูุฃูุซู ูุฌููุน ุงูุงุชุตุงูุงุช

### ูุซุงู ุชุฏูู ุงูุงุชุตุงู

```
[ุงููุถูู/ุงูุชุทุจูู] โ [CAKE ุนูู ุงููุงุฌูุฉ] โ [ุงูุฅูุชุฑูุช]
                            โ
                      cake-autortt ูุฑุงูุจ
                      ุงูุงุชุตุงูุงุช ุงููุดุทุฉ ู
                      ูุถุจุท ูุนุงูู RTT
```

## ๐ ุงูุณููู ุงููุชููุน

ุจุนุฏ ุงูุชุซุจูุช ูุงูุจุฏุกุ ูุฌุจ ุฃู ุชูุงุญุธ:

### ุงูุชุฃุซูุฑุงุช ุงูููุฑูุฉ
- ุงูุฎุฏูุฉ ุชุจุฏุฃ ุชููุงุฆูุงู ุนุจุฑ systemd ูุชุจุฏุฃ ูุฑุงูุจุฉ ุงูุงุชุตุงูุงุช
- ููุงุณุงุช RTT ุชูุณุฌู ูู ุณุฌูุงุช ุงููุธุงู (ุฅุฐุง ูุงู ุงูุชุตุญูุญ ูููููุงู)
- ูุนุงูู CAKE qdisc RTT ููุญุฏุซ ูู 30 ุซุงููุฉ ุจูุงุกู ุนูู ุธุฑูู ุงูุดุจูุฉ ุงูููุงุณุฉ
- ููู RTT ุนุงููุฉ ุงูุฏูุฉ (ูุซู 44.89ms) ุชูุทุจู ุนูู CAKE qdisc

### ุงูููุงุฆุฏ ุทูููุฉ ุงููุฏู
- **ุงุณุชุฌุงุจุฉ ูุญุณูุฉ**: ูุนุงูู RTT ููุญุฏุซ ุจุงุณุชูุฑุงุฑ ูุน ุธุฑูู ุงูุดุจูุฉ ุงููุนููุฉ
- **ุชุญูู ุฃูุถู ูู Bufferbloat**: CAKE ููููู ุงุชุฎุงุฐ ูุฑุงุฑุงุช ุฃูุซุฑ ุงุณุชูุงุฑุฉ ุญูู ุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ
- **ุฃุฏุงุก ุชูููู**: ูุชููู ุชููุงุฆูุงู ูุน ุธุฑูู ุงูุดุจูุฉ ุงููุชุบูุฑุฉ (ุงูุฃููุงุฑ ุงูุตูุงุนูุฉุ ุงููุญูููุ ุงูุฑูุงุจุท ุงููุฒุฏุญูุฉ)
- **ุฏูุฉ ุฃุนูู**: ูุฃุฎุฐ ุนููุงุช ูู ุญุชู 20 ูุถูู ูุชูุซูู ุฃูุถู ูุธุฑูู ุงูุดุจูุฉ

### ุงููุฑุงูุจุฉ

```bash
# ุงูุชุญูู ูู ุญุงูุฉ ุงูุฎุฏูุฉ
sudo systemctl status cake-autortt

# ุนุฑุถ ุณุฌูุงุช ุงูุฎุฏูุฉ
sudo journalctl -u cake-autortt -f

# ูุฑุงูุจุฉ ูุนุงููุงุช CAKE qdisc
tc qdisc show | grep cake

# ูุถุน ุงูุชุตุญูุญ ููุชุณุฌูู ุงูููุตู
sudo nano /etc/default/cake-autortt
# ุชุนููู DEBUG=1ุ ุซู:
sudo systemctl restart cake-autortt
```

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง

### ุงููุดุงูู ุงูุดุงุฆุนุฉ

1. **ุงูุฎุฏูุฉ ูุง ุชุจุฏุฃ**
   ```bash
   # ุงูุชุญูู ูู ุงูุชุจุนูุงุช
   which ping tc
   
   # ุงูุชุญูู ูู ูุงุฌูุงุช CAKE
   tc qdisc show | grep cake
   
   # ุงูุชุญูู ูู ุณุฌูุงุช ุงูุฎุฏูุฉ
   sudo journalctl -u cake-autortt --no-pager
   ```

2. **ูุง ุชูุฌุฏ ุชุญุฏูุซุงุช RTT**
   ```bash
   # ุชูููู ูุถุน ุงูุชุตุญูุญ
   sudo nano /etc/default/cake-autortt
   # ุชุนููู DEBUG=1
   
   sudo systemctl restart cake-autortt
   
   # ุงูุชุญูู ูู ุงูุณุฌูุงุช
   sudo journalctl -u cake-autortt -f
   ```

3. **ูุดู ุงูุชุดุงู ุงููุงุฌูุฉ**
   ```bash
   # ุชุญุฏูุฏ ุงููุงุฌูุงุช ูุฏููุงู ูู ุงูุชูููู
   sudo nano /etc/default/cake-autortt
   # ุชุนููู DL_INTERFACE ูUL_INTERFACE
   
   sudo systemctl restart cake-autortt
   ```

4. **CAKE qdisc ุบูุฑ ููุฌูุฏ**
   ```bash
   # ุงูุชุญูู ูู ุฏุนู CAKE
   tc qdisc help | grep cake
   
   # ุงูุชุญูู ูู ุชูููู CAKE ุนูู ุงููุงุฌูุฉ
   tc qdisc show
   
   # ุชูููู CAKE ุฅุฐุง ูุฒู ุงูุฃูุฑ (ุงูุธุฑ ูุณู ุงูุชุซุจูุช)
   ```

### ูุนูููุงุช ุงูุชุตุญูุญ

ูุน ุชูููู ุงูุชุตุญูุญ (`DEBUG=1` ูู `/etc/default/cake-autortt`)ุ ุชููุฑ ุงูุฎุฏูุฉ ุชุณุฌููุงู ููุตูุงู:

**ูุซุงู ูุฎุฑุฌุงุช ุงูุชุตุญูุญ:**
```bash
Jan 09 18:34:22 hostname cake-autortt[1234]: DEBUG: Extracting hosts from conntrack
Jan 09 18:34:22 hostname cake-autortt[1234]: DEBUG: Found 35 non-LAN hosts
Jan 09 18:34:22 hostname cake-autortt[1234]: DEBUG: Measuring RTT using ping for 35 hosts (3 pings each)
Jan 09 18:34:25 hostname cake-autortt[1234]: DEBUG: ping summary: 28/35 hosts alive
Jan 09 18:34:25 hostname cake-autortt[1234]: DEBUG: Using average RTT: 45.2ms (avg: 45.2ms, worst: 89.1ms)
Jan 09 18:34:25 hostname cake-autortt[1234]: DEBUG: Using measured RTT: 45.2ms
Jan 09 18:34:35 hostname cake-autortt[1234]: INFO: Adjusting CAKE RTT to 49.72ms (49720us)
Jan 09 18:34:35 hostname cake-autortt[1234]: DEBUG: Updated RTT on download interface ifb0
Jan 09 18:34:35 hostname cake-autortt[1234]: DEBUG: Updated RTT on upload interface eth0
```

> [!NOTE]  
> **ุชุณุฌูู ูุนุงู ููุฐุงูุฑุฉ**: ุชุณุฌูู ุงูุชุตุญูุญ ูุญุณู ูููุน ููุถ ุงูุณุฌู. ููุงุณุงุช RTT ูููุถูููู ุงููุฑุฏููู ูุง ุชูุณุฌู ูุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ููุชุงุจุฉ ุงููุฑุต. ููุท ุงููุนูููุงุช ุงูููุฎุตุฉ ุชูุณุฌู ูู systemd journalุ ููุง ูุฌุนููุง ููุงุณุจุฉ ููุชุดุบูู ุงููุณุชูุฑ ุฏูู ููู ููุฑุท ููุณุฌู.

## ๐ ุงูุงุฎุชูุงูุงุช ุนู ุฅุตุฏุงุฑ OpenWrt

ูุฐุง ุงูุฅุตุฏุงุฑ Ubuntu/Debian ูุฎุชูู ุนู ุฅุตุฏุงุฑ OpenWrt ูู ุนุฏุฉ ุฌูุงูุจ ุฑุฆูุณูุฉ:

### ูุธุงู ุงูุชูููู
- **OpenWrt**: ูุณุชุฎุฏู ูุธุงู ุชูููู UCI (`uci set`, `/etc/config/cake-autortt`)
- **Ubuntu/Debian**: ูุณุชุฎุฏู ูููุงุช ุชูููู ุชูููุฏูุฉ (`/etc/default/cake-autortt`)

### ุฅุฏุงุฑุฉ ุงูุฎุฏูุฉ
- **OpenWrt**: ูุณุชุฎุฏู procd ูุณูุฑูุจุชุงุช init.d ุงูุฎุงุตุฉ ุจู OpenWrt
- **Ubuntu/Debian**: ูุณุชุฎุฏู ุฅุฏุงุฑุฉ ุฎุฏูุฉ systemd

### ูุฑุงูุจุฉ ุงููุงุฌูุฉ
- **OpenWrt**: ูุณุชุฎุฏู ุณูุฑูุจุชุงุช hotplug.d ูุฃุญุฏุงุซ ุงููุงุฌูุฉ
- **Ubuntu/Debian**: ูุณุชุฎุฏู ููุงุนุฏ udev ููุฑุงูุจุฉ ุงููุงุฌูุฉ

### ุฅุฏุงุฑุฉ ุงูุญุฒู
- **OpenWrt**: ูุณุชุฎุฏู ูุฏูุฑ ุญุฒู opkg
- **Ubuntu/Debian**: ูุณุชุฎุฏู ูุฏูุฑ ุญุฒู apt

### ููุงูุน ุงููููุงุช
- **OpenWrt**: ูุณุชุฎุฏู ูุณุงุฑุงุช ุฎุงุตุฉ ุจู OpenWrt (`/etc/config/`, `/etc/hotplug.d/`)
- **Ubuntu/Debian**: ูุณุชุฎุฏู ูุณุงุฑุงุช Linux ููุงุณูุฉ (`/etc/default/`, `/etc/systemd/`, `/etc/udev/`)

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช GNU General Public License v2.0 - ุงูุธุฑ ููู [LICENSE](../LICENSE) ููุชูุงุตูู.

## ๐ค ุงููุณุงููุฉ

ุงููุณุงููุงุช ูุฑุญุจ ุจูุง! ูุฑุฌู ุฅุฑุณุงู Pull Request. ุนูุฏ ุงููุณุงููุฉ ูู ุฅุตุฏุงุฑ Ubuntu/Debianุ ูุฑุฌู ุถูุงู ุงูุชูุงูู ูุน ูู ูู ุฅุตุฏุงุฑุงุช Ubuntu LTS ุงูุญุงููุฉ ูDebian ุงููุณุชูุฑุฉ.